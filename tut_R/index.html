<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Tade Souaiaia" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>R Tutorial - prsWorkshop</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "R Tutorial";
        var mkdocs_page_input_path = "tut_R.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> prsWorkshop
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Pre-Workshop</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../prep_list/">Checklist</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../prep_os/">Operating System</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../prep_terminal/">Terminal Setup</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../prep_software/">Software Installs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../prep_testing/">Testing</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Pre-Workshop Tutorials</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../tut_intro/">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tut_bash/">Bash Tutorial</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">R Tutorial</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#basics">Basics</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#libraries">Libraries</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#variables-in-r">Variables in R</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#functions">Functions</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#plotting">Plotting</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#regression-models">Regression Models</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tut_python/">Python Tutorial</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tut_plink/">Plink Tutorial</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Program</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../practicals/workshop_practical_paul1/">Day1 (AM)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../practicals/workshop_practical_tade/">Day1 (PM)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../practicals/workshop_practical_clive/">Day2 (AM)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../practicals/workshop_practical_paul2/">Day2 (PM)</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Misc</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../misc_linux/">Linux For Windows</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../misc_plink_problem/">Mac Security</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">prsWorkshop</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Pre-Workshop Tutorials</li>
      <li class="breadcrumb-item active">R Tutorial</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/tadesouaiaia/prsWorkshop-website/edit/master/docs/tut_R.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="introduction-to-r">Introduction to R</h1>
<p><strong>R</strong> is a useful programming language that allows us to perform a
variety of statis- tical tests and data manipulation. It can also be
used to generate fantastic data visualisations. Here we will go
through some of the basics of <strong>R</strong> so that you can better understand
the practicals throughout the workshop.</p>
<h2 id="basics">Basics</h2>
<p>To being type <strong>R</strong> in the terminal: </p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>R
</code></pre></div>
<h2 id="libraries">Libraries</h2>
<p>Most functionality of <strong>R</strong> is organised in packages or
libraries. To access these functions, we will have to install and
load these packages. Most commonly used packages are installed
together with the standard installation process. You can install a new
library using the install.packages function.</p>
<p>For example, to install <em>ggplot2</em>, run the command:</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>install.packages(&quot;ggplot2&quot;)
</code></pre></div>
<p>After installation, you can load the library by typing</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>    library(ggplot2)
</code></pre></div>
<h2 id="variables-in-r">Variables in R</h2>
<p>You can assign a value or values to any variable you want using \&lt;-.
 e.g</p>
<p>Assign a number to a</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>  a &lt;- 1
</code></pre></div>
<p>Assign a vector containing a,b,c to v1</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>  v1 &lt;- c(&quot;a&quot;, &quot;b&quot;,&quot;c&quot;)
</code></pre></div>
<h2 id="functions">Functions</h2>
<p>You can perform lots of operations in <strong>R</strong> using diﬀerent built-in R
 functions. Some examples are below:</p>
<p>Assign number of samples</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>    nsample &lt;- 10000
</code></pre></div>
<p>Generate nsample random normal variable with mean = 0 and sd = 1</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>    normal &lt;- rnorm(nsample, mean=0,sd=1)

    normal.2 &lt;- rnorm(nsample, mean=0,sd=1)
</code></pre></div>
<p>We can examine the first few entries of the result using head</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>  head(normal)
</code></pre></div>
<p>And we can obtain the mean and sd using</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>  mean(normal)

  sd(normal)
</code></pre></div>
<p>We can also calculate the correlation between two variables
 using cor</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>  cor(normal, normal.2)
</code></pre></div>
<h2 id="plotting">Plotting</h2>
<p>While <strong>R</strong> contains many powerful plotting functions in its base
 packages,customisationn can be diﬃcult (e.g. changing the colour
 scales, arranging the axes). <strong>ggplot2</strong> is a powerful visualization package that provides extensive
 flexibility and customi- sation of plots. As an example, we can do the following</p>
<p>Load the package</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>  library(ggplot2)
</code></pre></div>
<p>Specify sample size</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>  nsample &lt;-1000
</code></pre></div>
<p>Generate random grouping using sample with replacement</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code> groups &lt;- sample(c(&quot;a&quot;,&quot;b&quot;), nsample, replace=T)
</code></pre></div>
<p>Now generate the data</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code> dat &lt;- data.frame(x=rnorm(nsample), y=rnorm(nsample), groups)
</code></pre></div>
<p>Generate a scatter plot with diﬀerent coloring based on group</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code> ggplot(dat, aes(x=x,y=y,color=groups))+geom_point()
</code></pre></div>
<h2 id="regression-models">Regression Models</h2>
<p>In statistical modelling, regression analyses are a set of statistical
 techniques for estimating the relationships among variables or
 features. We can perform regression analysis in <strong>R</strong>.</p>
<p>Use the following code to perform linear regression on simulated
 variables "x" and "y":</p>
<p>Simulate data</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code> nsample &lt;- 10000

 x &lt;- rnorm(nsample)

 y &lt;- rnorm(nsample)
</code></pre></div>
<p>Run linear regression</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>  lm(y~x)
</code></pre></div>
<p>We can store the result into a variable</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>   reg &lt;- lm(y~x)
</code></pre></div>
<p>And get a detailed output using summary</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>   summary(lm(y~x))
</code></pre></div>
<p>We can also extract the coeﬃcient of regression using</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>   reg$coefficient
</code></pre></div>
<p>And we can obtain the residuals by</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>  residual &lt;- resid(reg)
</code></pre></div>
<p>Examine the first few entries of residuals</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>   head(residual)
</code></pre></div>
<p>We can also include covariates into the model</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>  covar &lt;- rnorm(nsample)

  lm(y~x+covar)
</code></pre></div>
<p>And can even perform interaction analysis</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>  lm(y~x+covar+x*covar)
</code></pre></div>
<p>Alternatively, we can use the glm function to perform the regression:</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>  glm(y~x)
</code></pre></div>
<p>For binary traits (case controls studies), logistic regression can be
 performed using</p>
<p>Simulate samples</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>  nsample &lt;- 10000

  x &lt;- rnorm(nsample)
</code></pre></div>
<p>Simulate binary traits (must be coded with 0 and 1)</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>  y &lt;- sample(c(0,1), size=nsample, replace=T)
</code></pre></div>
<p>Perform logistic regression</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>  glm(y~x, family=binomial)
</code></pre></div>
<p>Obtain the detailed output</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>  summary(glm(y~x, family=binomial))
</code></pre></div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../tut_bash/" class="btn btn-neutral float-left" title="Bash Tutorial"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../tut_python/" class="btn btn-neutral float-right" title="Python Tutorial">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/tadesouaiaia/prsWorkshop-website" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../tut_bash/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../tut_python/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      <script src="../javascripts/details.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
